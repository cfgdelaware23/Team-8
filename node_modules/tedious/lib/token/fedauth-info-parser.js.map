{"version":3,"file":"fedauth-info-parser.js","names":["_token","require","FEDAUTHINFOID","STSURL","SPN","fedAuthInfoParser","parser","_options","callback","readUInt32LE","tokenLength","readBuffer","data","spn","stsurl","offset","countOfInfoIDs","i","fedauthInfoID","readUInt8","fedAuthInfoDataLen","fedAuthInfoDataOffset","toString","FedAuthInfoToken","_default","exports","default","module"],"sources":["../../src/token/fedauth-info-parser.ts"],"sourcesContent":["import Parser, { type ParserOptions } from './stream-parser';\nimport { FedAuthInfoToken } from './token';\n\nconst FEDAUTHINFOID = {\n  STSURL: 0x01,\n  SPN: 0x02\n};\n\nfunction fedAuthInfoParser(parser: Parser, _options: ParserOptions, callback: (token: FedAuthInfoToken) => void) {\n  parser.readUInt32LE((tokenLength) => {\n    parser.readBuffer(tokenLength, (data) => {\n      let spn: string | undefined, stsurl: string | undefined;\n\n      let offset = 0;\n\n      const countOfInfoIDs = data.readUInt32LE(offset);\n      offset += 4;\n\n      for (let i = 0; i < countOfInfoIDs; i++) {\n        const fedauthInfoID = data.readUInt8(offset);\n        offset += 1;\n\n        const fedAuthInfoDataLen = data.readUInt32LE(offset);\n        offset += 4;\n\n        const fedAuthInfoDataOffset = data.readUInt32LE(offset);\n        offset += 4;\n\n        switch (fedauthInfoID) {\n          case FEDAUTHINFOID.SPN:\n            spn = data.toString('ucs2', fedAuthInfoDataOffset, fedAuthInfoDataOffset + fedAuthInfoDataLen);\n            break;\n\n          case FEDAUTHINFOID.STSURL:\n            stsurl = data.toString('ucs2', fedAuthInfoDataOffset, fedAuthInfoDataOffset + fedAuthInfoDataLen);\n            break;\n\n          // ignoring unknown fedauthinfo options\n          default:\n            break;\n        }\n      }\n\n      callback(new FedAuthInfoToken(spn, stsurl));\n    });\n  });\n}\n\nexport default fedAuthInfoParser;\nmodule.exports = fedAuthInfoParser;\n"],"mappings":";;;;;;AACA,IAAAA,MAAA,GAAAC,OAAA;AAEA,MAAMC,aAAa,GAAG;EACpBC,MAAM,EAAE,IAAI;EACZC,GAAG,EAAE;AACP,CAAC;AAED,SAASC,iBAAiBA,CAACC,MAAc,EAAEC,QAAuB,EAAEC,QAA2C,EAAE;EAC/GF,MAAM,CAACG,YAAY,CAAEC,WAAW,IAAK;IACnCJ,MAAM,CAACK,UAAU,CAACD,WAAW,EAAGE,IAAI,IAAK;MACvC,IAAIC,GAAuB,EAAEC,MAA0B;MAEvD,IAAIC,MAAM,GAAG,CAAC;MAEd,MAAMC,cAAc,GAAGJ,IAAI,CAACH,YAAY,CAACM,MAAM,CAAC;MAChDA,MAAM,IAAI,CAAC;MAEX,KAAK,IAAIE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,cAAc,EAAEC,CAAC,EAAE,EAAE;QACvC,MAAMC,aAAa,GAAGN,IAAI,CAACO,SAAS,CAACJ,MAAM,CAAC;QAC5CA,MAAM,IAAI,CAAC;QAEX,MAAMK,kBAAkB,GAAGR,IAAI,CAACH,YAAY,CAACM,MAAM,CAAC;QACpDA,MAAM,IAAI,CAAC;QAEX,MAAMM,qBAAqB,GAAGT,IAAI,CAACH,YAAY,CAACM,MAAM,CAAC;QACvDA,MAAM,IAAI,CAAC;QAEX,QAAQG,aAAa;UACnB,KAAKhB,aAAa,CAACE,GAAG;YACpBS,GAAG,GAAGD,IAAI,CAACU,QAAQ,CAAC,MAAM,EAAED,qBAAqB,EAAEA,qBAAqB,GAAGD,kBAAkB,CAAC;YAC9F;UAEF,KAAKlB,aAAa,CAACC,MAAM;YACvBW,MAAM,GAAGF,IAAI,CAACU,QAAQ,CAAC,MAAM,EAAED,qBAAqB,EAAEA,qBAAqB,GAAGD,kBAAkB,CAAC;YACjG;;UAEF;UACA;YACE;QACJ;MACF;MAEAZ,QAAQ,CAAC,IAAIe,uBAAgB,CAACV,GAAG,EAAEC,MAAM,CAAC,CAAC;IAC7C,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ;AAAC,IAAAU,QAAA,GAEcnB,iBAAiB;AAAAoB,OAAA,CAAAC,OAAA,GAAAF,QAAA;AAChCG,MAAM,CAACF,OAAO,GAAGpB,iBAAiB"}